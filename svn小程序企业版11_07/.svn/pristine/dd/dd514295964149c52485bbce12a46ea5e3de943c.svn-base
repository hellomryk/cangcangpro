// pages/znpgresult/znpgresult.js
var _this = null, zong ="https://chronic.infobigdata.com";
var app = getApp();
const url = 'http://192.168.1.244:8090';
function baogao(te) {
    wx.showLoading({
        title: '加载中',
    })
    _this.setData({
        pinggu_box_show: te==2?true:false,
    });
    // 智能评估自测查询结果11_07
    wx.request({
        url: url + '/api/disease/selfTesting/queryReport',
        data: {
            openId: app.globalData.openId,
            recordType: te
        },
        method: 'POST',
        header: {
            'Content-Type': 'application/x-www-form-urlencoded'
        },
        success(res) {
            console.log("查看自诊保存结果11_07")
            console.log(res)
            var arr1 = res.data.data.recordList;
            var arr2 = [];
            for (var i = 0; i < arr1.length; i++) {
                var obj = {}
                obj.id = arr1[i].id;
                obj.basicInfo = arr1[i].basicinfo
                obj.questioningSymptoms = JSON.parse(arr1[i].questioningsymptoms).diseaseName
                obj.time = arr1[i].evaluationtime
                arr2.push(obj)
            }
            _this.setData({
                array: arr2
            })
            wx.hideLoading();
        }
    })
}
Page({

  /**
   * 页面的初始数据
   */
  data: {
    pinggu_box_show: true,
    bopenid:'',
    array:[],
    zzhen:[]
  },

  /**
   * 生命周期函数--监听页面加载
   */
  onLoad: function (options) {
      _this = this;
    console.log("打印id")
    console.log(app.globalData.openId)
      var scf = 1;
      if (app.baogao.articleId != null) {
          scf = app.baogao.articleId
      } else {

      }

      if (scf == 1) {
          baogao(2)
      } else if (scf == 2) {
          baogao(1)
      }




 
  },
  showbox1() {

      baogao(2)
    
  },
  showbox2() {
      baogao(1)
  },
  gobaogao(e) {
    console.log(e)
    const id = e.currentTarget.id
    //   信息完善请求 


      if (wx.getStorageSync('userid')){

          wx.request({
              url: 'https://chronic-api.infobigdata.com/userDetail/verify',
              data: {
                  userId: wx.getStorageSync('userid')
              },
              header: {
                  'content-type': 'application/x-www-form-urlencoded' // 默认值application/json
              },
              method: "POST",
              success: function (res) {
                  console.log(res)
                  console.log(res.data.data)
                  if (res.data.data==0){
                      wx.navigateTo({
                          url: '/pages/wodexinxi/index',
                      })
                  } else if (res.data.data == 1){
                      wx.navigateTo({
                          url: '/pages/baogao/baogao?bid=' + id + '&bopenid=' + _this.data.bopenid,
                      })
                  }
                 

              }
          })
     
      }else{
          wx.navigateTo({
              url: '/pages/signup/signup',
          })
      }

    
  },
  /**
   * 生命周期函数--监听页面初次渲染完成
   */
  onReady: function () {

  },

  /**
   * 生命周期函数--监听页面显示
   */
  onShow: function () {
      var scf = 1;
      if (app.baogao.articleId != null) {
          scf = app.baogao.articleId
      } else {

      }

      if (scf == 1) {
          baogao(2)
      } else if (scf == 2) {
          baogao(1)
      }
  },

  /**
   * 生命周期函数--监听页面隐藏
   */
  onHide: function () {

  },

  /**
   * 生命周期函数--监听页面卸载
   */
  onUnload: function () {

  },

  /**
   * 页面相关事件处理函数--监听用户下拉动作
   */
  onPullDownRefresh: function () {

  },

  /**
   * 页面上拉触底事件的处理函数
   */
  onReachBottom: function () {

  },

  /**
   * 用户点击右上角分享
   */
  onShareAppMessage: function () {

  }
})
function getMyDate(str_time) {
      var date = new Date(str_time),
        year = date.getFullYear(),//年
        month = date.getMonth() + 1,//月
        day = date.getDate(),//日
        hour = date.getHours(),//时
        min = date.getMinutes(),//分
        sen = date.getSeconds(),//秒
        msen = date.getMilliseconds(),//毫秒
        time1 = year + '-' + getzf(month) + '-' + getzf(day) + ' ' + getzf(hour) + ':' + getzf(min) + ':' + getzf(sen),
        time = year + '-' + getzf(month) + '-' + getzf(day) + ' ' + getzf(hour) + ':' + getzf(min) + ':' + getzf(sen) + ':' + getzf(msen);
      return time1;
};
//补0操作  
function getzf(num) {
      if (parseInt(num) < 10) {
            num = '0' + num;
      }
      return num;
}

